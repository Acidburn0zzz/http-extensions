<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01//EN" "about:legacy-compat">
<html lang="en"><head profile="http://dublincore.org/documents/2008/08/04/dc-html/"><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Opportunistic Security for HTTP</title><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css"><style type="text/css">
      body {
        padding-top: 80px;
        padding-bottom: 80px;
        position: relative;
      }
      .table.header th, .table.header td {
        border-top: none;
        padding: 0;
      }
      #rfc\.meta {
        width: 40%;
        float: right
      }
      #rfc\.toc > ul li {
        list-style: none;
      }
      .container .nav-sublist {
        padding-left: 20px;
        padding-right: 10px;
        font-size: 90%;
      }
      .container .navbar-brand {
        padding-top: 0;
      }
      .container .nav > li > a {
        padding: 10px 7px 5px 15px;
        display: inline-block;
      }
      .container .nav > li > a + a {
        padding: 10px 15px 5px 7px;
        display: inline-block;
      }
      .container .nav > li > a {
        padding: 5px 10px;
      }
      .filename {
        color: rgb(119, 119, 119);
        font-size: 23px;
        font-weight: normal;
        height: auto;
        line-height: 23px;
      }
      dl {
        margin-left: 1em;
      }
      dl.dl-horizontal: {
        margin-left: 0;
      }
      dl > dt {
        float: left;
        margin-right: 1em;
      }
      dl.nohang > dt {
        float: none;
      }
      dl > dd {
        margin-bottom: .5em;
      }
      dl.compact > dd {
        margin-bottom: 0em;
      }
      dl > dd > dl {
        margin-top: 0.5em;
        margin-bottom: 0em;
      }
      ul.empty {
        list-style-type: none;
      }
      ul.empty li {
        margin-top: .5em;
      }
      td.reference {
        padding-right: 1em;
        vertical-align: top;
      }
      .feedback {
        position: fixed;
        bottom: 5px;
        right: 5px;
      }
      .fbbutton {
        margin-left: 5px;
      }
      h1 a, h2 a, h3 a, h4 a, h5 a, h6 a {
        color: rgb(51, 51, 51);
      }
    </style><link rel="Author" href="#rfc.authors"><link rel="Copyright" href="#rfc.copyrightnotice"><link rel="Chapter" title="1 Introduction" href="#rfc.section.1"><link rel="Chapter" title="2 Using HTTP URIs over TLS" href="#rfc.section.2"><link rel="Chapter" title="3 Server Authentication" href="#rfc.section.3"><link rel="Chapter" title="4 Interaction with “https” URIs" href="#rfc.section.4"><link rel="Chapter" title="5 Requiring Use of TLS" href="#rfc.section.5"><link rel="Chapter" title="6 Security Considerations" href="#rfc.section.6"><link rel="Chapter" href="#rfc.section.7" title="7 References"><link rel="Appendix" title="A Acknowledgements" href="#rfc.section.A"><meta name="generator" content="https://github.com/mnot/RFCBootstrap XSLT vendor: SAXON 9.1.0.8 from Saxonica http://www.saxonica.com/"><meta name="keywords" content="Internet-Draft"><link rel="schema.dct" href="http://purl.org/dc/terms/"><meta name="dct.creator" content="Nottingham, M."><meta name="dct.creator" content="Thomson, M."><meta name="dct.identifier" content="urn:ietf:id:draft-ietf-httpbis-http2-encryption-latest"><meta name="dct.issued" scheme="ISO8601" content="2015-12-18"><meta name="dct.abstract" content="This document describes how http URIs can be accessed using Transport Layer Security (TLS) to mitigate pervasive monitoring attacks."><meta name="description" content="This document describes how http URIs can be accessed using Transport Layer Security (TLS) to mitigate pervasive monitoring attacks."></head><body><div class="container" id="top"><div class="row"><div class="col-md-4 col-md-push-8 hidden-sm hidden-xs" role="navigation"><div class="navbar"><div class="navbar-brand"><a href="#top">Internet-Draft</a></div><br clear="all"><div class=""><div id="rfc.toc"><ul class="nav"><li><a href="#rfc.section.1">1.</a>&nbsp;&nbsp;&nbsp;<a href="#introduction">Introduction</a><ul><li><a href="#rfc.section.1.1">1.1</a>&nbsp;&nbsp;&nbsp;<a href="#goals-and-non-goals">Goals and Non-Goals</a></li><li><a href="#rfc.section.1.2">1.2</a>&nbsp;&nbsp;&nbsp;<a href="#notational-conventions">Notational Conventions</a></li></ul></li><li><a href="#rfc.section.2">2.</a>&nbsp;&nbsp;&nbsp;<a href="#using-http-uris-over-tls">Using HTTP URIs over TLS</a></li><li><a href="#rfc.section.3">3.</a>&nbsp;&nbsp;&nbsp;<a href="#auth">Server Authentication</a></li><li><a href="#rfc.section.4">4.</a>&nbsp;&nbsp;&nbsp;<a href="#interaction-with-https-uris">Interaction with “https” URIs</a></li><li><a href="#rfc.section.5">5.</a>&nbsp;&nbsp;&nbsp;<a href="#http-tls">Requiring Use of TLS</a><ul><li><a href="#rfc.section.5.1">5.1</a>&nbsp;&nbsp;&nbsp;<a href="#the-http-tls-header-field">The HTTP-TLS Header Field</a></li><li><a href="#rfc.section.5.2">5.2</a>&nbsp;&nbsp;&nbsp;<a href="#pinrisks">Operational Considerations</a></li></ul></li><li><a href="#rfc.section.6">6.</a>&nbsp;&nbsp;&nbsp;<a href="#security-considerations">Security Considerations</a><ul><li><a href="#rfc.section.6.1">6.1</a>&nbsp;&nbsp;&nbsp;<a href="#security-indicators">Security Indicators</a></li><li><a href="#rfc.section.6.2">6.2</a>&nbsp;&nbsp;&nbsp;<a href="#downgrade">Downgrade Attacks</a></li><li><a href="#rfc.section.6.3">6.3</a>&nbsp;&nbsp;&nbsp;<a href="#privacy">Privacy Considerations</a></li><li><a href="#rfc.section.6.4">6.4</a>&nbsp;&nbsp;&nbsp;<a href="#confusion-regarding-request-scheme">Confusion Regarding Request Scheme</a></li></ul></li><li><a href="#rfc.section.7">7.</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.references">References</a><ul><li><a href="#rfc.section.7.1">7.1</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.references.1">Normative References</a></li><li><a href="#rfc.section.7.2">7.2</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.references.2">Informative References</a></li></ul></li><li><a href="#rfc.section.A">A.</a>&nbsp;&nbsp;&nbsp;<a href="#acknowledgements">Acknowledgements</a></li><li><a href="#rfc.authors">Authors' Addresses</a></li></ul></div></div></div></div><div class="col-md-8 col-md-pull-4 main" role="main"><table class="table table-condensed header" id="rfc.headerblock"><tbody><tr><td class="text-left">HTTP Working Group</td><td class="text-right">M. Nottingham</td></tr><tr><td class="text-left">Internet-Draft</td><td class="text-right">M. Thomson</td></tr><tr><td class="text-left">Intended status: Experimental</td><td class="text-right">Mozilla</td></tr><tr><td class="text-left">Expires: June 20, 2016</td><td class="text-right">December 18, 2015</td></tr></tbody></table><div id="rfc.title"><h1>Opportunistic Security for HTTP</h1><div class="filename">draft-ietf-httpbis-http2-encryption-latest</div></div><hr><h2 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h2><div class="lead"><p>This document describes how <tt>http</tt> URIs can be accessed using Transport Layer Security (TLS) to mitigate pervasive monitoring attacks.</p></div><div id="rfc.status"><h2><a href="#rfc.status">Status of this Memo</a></h2><p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p><p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF). Note that other groups may also distribute working documents as Internet-Drafts. The list of current Internet-Drafts is at <a href="http://datatracker.ietf.org/drafts/current/">http://datatracker.ietf.org/drafts/current/</a>.</p><p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time. It is inappropriate to use Internet-Drafts as reference material or to cite them other than as “work in progress”.</p><p>This Internet-Draft will expire on June 20, 2016.</p></div><div id="rfc.copyrightnotice"><h2><a href="#rfc.copyrightnotice">Copyright Notice</a></h2><p>Copyright © 2015 IETF Trust and the persons identified as the document authors. All rights reserved.</p><p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of publication of this document. Please review these documents carefully, as they describe your rights and restrictions with respect to this document. Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p></div><div id="introduction"><h2 id="rfc.section.1" class="np"><a href="#rfc.section.1">1.</a>&nbsp;<a href="#introduction">Introduction</a></h2><div id="rfc.section.1.p.1"><p>This document describes a use of HTTP Alternative Services <a href="#I-D.ietf-httpbis-alt-svc"><cite title="HTTP Alternative Services">[I-D.ietf-httpbis-alt-svc]</cite></a> to decouple the URI scheme from the use and configuration of underlying encryption, allowing a <tt>http</tt> URI to be accessed using TLS <a href="#RFC5246"><cite title="The Transport Layer Security (TLS) Protocol Version 1.2">[RFC5246]</cite></a> opportunistically.</p></div><div id="rfc.section.1.p.2"><p>Serving <tt>https</tt> URIs require acquiring and configuring a valid certificate, which means that some deployments find supporting TLS difficult. This document describes a usage model whereby sites can serve <tt>http</tt> URIs over TLS without being required to support strong server authentication.</p></div><div id="rfc.section.1.p.3"><p>Opportunistic Security <a href="#RFC7435"><cite title="Opportunistic Security: Some Protection Most of the Time">[RFC7435]</cite></a> does not provide the same guarantees as using TLS with <tt>https</tt> URIs; it is vulnerable to active attacks, and does not change the security context of the connection. Normally, users will not be able to tell that it is in use (i.e., there will be no “lock icon”).</p></div><div id="rfc.section.1.p.4"><p>By its nature, this technique is vulnerable to active attacks. A mechanism for partially mitigating them is described in <a href="#http-tls" title="Requiring Use of TLS">Section&nbsp;5</a>.</p></div><div id="goals-and-non-goals"><h3 id="rfc.section.1.1"><a href="#rfc.section.1.1">1.1</a>&nbsp;<a href="#goals-and-non-goals">Goals and Non-Goals</a></h3><div id="rfc.section.1.1.p.1"><p>The immediate goal is to make the use of HTTP more robust in the face of pervasive passive monitoring <a href="#RFC7258"><cite title="Pervasive Monitoring Is an Attack">[RFC7258]</cite></a>.</p></div><div id="rfc.section.1.1.p.2"><p>A secondary goal is to limit the potential for active attacks. It is not intended to offer the same level of protection as afforded to <tt>https</tt> URIs, but instead to increase the likelihood that an active attack can be detected.</p></div><div id="rfc.section.1.1.p.3"><p>A final (but significant) goal is to provide for ease of implementation, deployment and operation. This mechanism is expected to have a minimal impact upon performance, and require a trivial administrative effort to configure.</p></div></div><div id="notational-conventions"><h3 id="rfc.section.1.2"><a href="#rfc.section.1.2">1.2</a>&nbsp;<a href="#notational-conventions">Notational Conventions</a></h3><div id="rfc.section.1.2.p.1"><p>The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL” in this document are to be interpreted as described in <a href="#RFC2119"><cite title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</cite></a>.</p></div></div></div><div id="using-http-uris-over-tls"><h2 id="rfc.section.2"><a href="#rfc.section.2">2.</a>&nbsp;<a href="#using-http-uris-over-tls">Using HTTP URIs over TLS</a></h2><div id="rfc.section.2.p.1"><p>An origin server that supports the resolution of <tt>http</tt> URIs can indicate support for this specification by providing an alternative service advertisement <a href="#I-D.ietf-httpbis-alt-svc"><cite title="HTTP Alternative Services">[I-D.ietf-httpbis-alt-svc]</cite></a> for a protocol identifier that uses TLS, such as <tt>h2</tt> <a href="#RFC7540"><cite title="Hypertext Transfer Protocol Version 2 (HTTP/2)">[RFC7540]</cite></a>.</p></div><div id="rfc.section.2.p.2"><p>A client that receives such an advertisement MAY make future requests intended for the associated origin (<a href="#RFC6454"><cite title="The Web Origin Concept">[RFC6454]</cite></a>) to the identified service (as specified by <a href="#I-D.ietf-httpbis-alt-svc"><cite title="HTTP Alternative Services">[I-D.ietf-httpbis-alt-svc]</cite></a>).</p></div><div id="rfc.section.2.p.3"><p>A client that places the importance of protection against passive attacks over performance might choose to withhold requests until an encrypted connection is available. However, if such a connection cannot be successfully established, the client can resume its use of the cleartext connection.</p></div><div id="rfc.section.2.p.4"><p>A client can also explicitly probe for an alternative service advertisement by sending a request that bears little or no sensitive information, such as one with the OPTIONS method. Likewise, clients with existing alternative services information could make such a request before they expire, in order minimize the delays that might be incurred.</p></div></div><div id="auth"><h2 id="rfc.section.3"><a href="#rfc.section.3">3.</a>&nbsp;<a href="#auth">Server Authentication</a></h2><div id="rfc.section.3.p.1"><p>By their nature, <tt>http</tt> URIs do not require cryptographically strong server authentication; that is only implied by <tt>https</tt> URIs. Furthermore, doing so (as per <a href="#RFC2818"><cite title="HTTP Over TLS">[RFC2818]</cite></a>) creates a number of operational challenges. For these reasons, server authentication is not mandatory for <tt>http</tt> URIs when using the mechanism described in this specification.</p></div><div id="rfc.section.3.p.2"><p>When connecting to an alternative service for an <tt>http</tt> URI, clients are not required to perform the server authentication procedure described in Section 3.1 of <a href="#RFC2818"><cite title="HTTP Over TLS">[RFC2818]</cite></a>. The server certificate, if one is proffered by the alternative service, is not necessarily checked for validity, expiration, issuance by a trusted certificate authority or matched against the name in the URI. Therefore, the alternative service can provide any certificate, or even select TLS cipher suites that do not include authentication.</p></div><div id="rfc.section.3.p.3"><p>A client MAY perform additional checks on the offered certificate if the server does not select an unauthenticated TLS cipher suite. This document doesn’t define any such checks, though clients could be configured with a policy that defines what is acceptable.</p></div><div id="rfc.section.3.p.4"><p>As stipulated by <a href="#I-D.ietf-httpbis-alt-svc"><cite title="HTTP Alternative Services">[I-D.ietf-httpbis-alt-svc]</cite></a>, clients MUST NOT use alternative services with a host other than the origin’s, unless the alternative service itself is strongly authenticated (as the origin’s host); for example, using TLS with a certificate that validates as per <a href="#RFC2818"><cite title="HTTP Over TLS">[RFC2818]</cite></a>.</p></div></div><div id="interaction-with-https-uris"><h2 id="rfc.section.4"><a href="#rfc.section.4">4.</a>&nbsp;<a href="#interaction-with-https-uris">Interaction with “https” URIs</a></h2><div id="rfc.section.4.p.1"><p>When using alternative services, requests for resources identified by both <tt>http</tt> and <tt>https</tt> URIs might use the same connection, because HTTP/2 permits requests for multiple origins on the same connection.</p></div><div id="rfc.section.4.p.2"><p>Since <tt>https</tt> URIs rely on server authentication, a connection that is initially created for <tt>http</tt> URIs without authenticating the server cannot be used for <tt>https</tt> URIs until the server certificate is successfully authenticated. Section 3.1 of <a href="#RFC2818"><cite title="HTTP Over TLS">[RFC2818]</cite></a> describes the basic mechanism, though the authentication considerations in <a href="#I-D.ietf-httpbis-alt-svc"><cite title="HTTP Alternative Services">[I-D.ietf-httpbis-alt-svc]</cite></a> also apply.</p></div><div id="rfc.section.4.p.3"><p>Connections that are established without any means of server authentication (for instance, the purely anonymous TLS cipher suites), cannot be used for <tt>https</tt> URIs.</p></div></div><div id="http-tls"><h2 id="rfc.section.5"><a href="#rfc.section.5">5.</a>&nbsp;<a href="#http-tls">Requiring Use of TLS</a></h2><div id="rfc.section.5.p.1"><p>Editors’ Note: this is a very rough take on an approach that would provide a limited form of protection against downgrade attack. It’s unclear at this point whether the additional effort (and modest operational cost) is worthwhile.</p></div><div id="rfc.section.5.p.2" class="avoidbreakafter"><p>The mechanism described in this specification is trivial to mount an active attack against, for two reasons:</p></div><div id="rfc.section.5.p.3"><ul><li>A client that doesn’t perform authentication is an easy victim of server impersonation, through man-in-the-middle attacks.</li><li>A client that is willing to use HTTP over cleartext to resolve the resource will do so if access to any TLS-enabled alternative services is blocked at the network layer.</li></ul></div><div id="rfc.section.5.p.4"><p>Given that the primary goal of this specification is to prevent passive attacks, these are not critical failings (especially considering the alternative - HTTP over cleartext). However, a modest form of protection against active attacks can be provided for clients on subsequent connections.</p></div><div id="rfc.section.5.p.5"><p>When an alternative service is able to commit to providing service for a particular origin over TLS for a bounded period of time, clients can choose to rely upon its availability, failing when it cannot be contacted. Effectively, this makes the choice to use a secured protocol “sticky” in the client.</p></div><div id="the-http-tls-header-field"><h3 id="rfc.section.5.1"><a href="#rfc.section.5.1">5.1</a>&nbsp;<a href="#the-http-tls-header-field">The HTTP-TLS Header Field</a></h3><div id="rfc.section.5.1.p.1" class="avoidbreakafter"><p>A alternative service can make this commitment by sending a <tt>HTTP-TLS</tt> header field, described here using the ‘#’ ABNF extension defined in Section 7 of <a href="#RFC7230"><cite title="Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing">[RFC7230]</cite></a>:</p></div><div id="rfc.figure.u.1"><pre>
HTTP-TLS     = 1#parameter
</pre></div><div id="rfc.section.5.1.p.2"><p>When it appears in a HTTP response from a strongly authenticated alternative service, this header field indicates that the availability of the origin through TLS-protected alternative services is “sticky”, and that the client MUST NOT fall back to cleartext protocols while this information is considered fresh.</p></div><div id="rfc.section.5.1.p.3" class="avoidbreakafter"><p>For example:</p></div><div id="rfc.figure.u.2"><pre>
GET /index.html HTTP/1.1
Host: example.com


HTTP/1.1 200 OK
Content-Type: text/html
Cache-Control: max-age=600
Age: 30
Date: Thu, 1 May 2014 16:20:09 GMT
HTTP-TLS: ma=3600
</pre></div><div id="rfc.section.5.1.p.4"><p>This header field creates a commitment from the origin <a href="#RFC6454"><cite title="The Web Origin Concept">[RFC6454]</cite></a> of the associated resource (in the example, <tt>http://example.com</tt>). For the duration of the commitment, clients SHOULD strongly authenticate the server for all subsequent requests made to that origin, though this creates some risks for clients (see <a href="#pinrisks" title="Operational Considerations">Section&nbsp;5.2</a>).</p></div><div id="rfc.section.5.1.p.5"><p>Authentication for HTTP over TLS is described in Section 3.1 of <a href="#RFC2818"><cite title="HTTP Over TLS">[RFC2818]</cite></a>, noting the additional requirements in Section 2.1 of <a href="#I-D.ietf-httpbis-alt-svc"><cite title="HTTP Alternative Services">[I-D.ietf-httpbis-alt-svc]</cite></a>. The header field MUST be ignored if strong authentication fails; otherwise, an attacker could create a persistent denial of service by falsifying a commitment.</p></div><div id="rfc.section.5.1.p.6"><p>The commitment to use authenticated TLS persists for a period determined by the value of the <tt>ma</tt> parameter. See Section 4.2.3 of <a href="#RFC7234"><cite title="Hypertext Transfer Protocol (HTTP/1.1): Caching">[RFC7234]</cite></a> for details of determining response age.</p></div><div id="rfc.figure.u.3"><pre>
ma-parameter     = delta-seconds
</pre></div><div id="rfc.section.5.1.p.7"><p>The commitment made by the <tt>HTTP-TLS</tt> header field applies only to the origin of the resource that generates the <tt>HTTP-TLS</tt> header field.</p></div><div id="rfc.section.5.1.p.8"><p>Requests for an origin that has a persisted, unexpired value for <tt>HTTP-TLS</tt> MUST fail if they cannot be made over an authenticated TLS connection.</p></div><div id="rfc.section.5.1.p.9"><p>Note that the commitment is not bound to a particular alternative service. Clients SHOULD use alternative services that they become aware of. However, clients MUST NOT use an unauthenticated alternative service for an origin with this commitment. Where there is an active commitment, clients MAY instead ignore advertisements for unsecured alternatives services.</p></div></div><div id="pinrisks"><h3 id="rfc.section.5.2"><a href="#rfc.section.5.2">5.2</a>&nbsp;<a href="#pinrisks">Operational Considerations</a></h3><div id="rfc.section.5.2.p.1"><p>To avoid situations where a persisted value of <tt>HTTP-TLS</tt> causes a client to be unable to contact a site, clients SHOULD limit the time that a value is persisted for a given origin. A lower limit might be appropriate for initial observations of <tt>HTTP-TLS</tt>; the certainty that a site has set a correct value - and the corresponding limit on persistence - can increase as the value is seen more over time.</p></div><div id="rfc.section.5.2.p.2"><p>Once a server has indicated that it will support authenticated TLS, a client MAY use key pinning <a href="#RFC7469"><cite title="Public Key Pinning Extension for HTTP">[RFC7469]</cite></a> or any other mechanism that would otherwise be restricted to use with <tt>https</tt> URIs, provided that the mechanism can be restricted to a single HTTP origin.</p></div></div></div><div id="security-considerations"><h2 id="rfc.section.6"><a href="#rfc.section.6">6.</a>&nbsp;<a href="#security-considerations">Security Considerations</a></h2><div id="security-indicators"><h3 id="rfc.section.6.1"><a href="#rfc.section.6.1">6.1</a>&nbsp;<a href="#security-indicators">Security Indicators</a></h3><div id="rfc.section.6.1.p.1"><p>User Agents MUST NOT provide any special security indicia when an <tt>http</tt> resource is acquired using TLS. In particular, indicators that might suggest the same level of security as <tt>https</tt> MUST NOT be used (e.g., using a “lock device”).</p></div></div><div id="downgrade"><h3 id="rfc.section.6.2"><a href="#rfc.section.6.2">6.2</a>&nbsp;<a href="#downgrade">Downgrade Attacks</a></h3><div id="rfc.section.6.2.p.1"><p>A downgrade attack against the negotiation for TLS is possible. With the <tt>HTTP-TLS</tt> header field, this is limited to occasions where clients have no prior information (see <a href="#privacy" title="Privacy Considerations">Section&nbsp;6.3</a>), or when persisted commitments have expired.</p></div><div id="rfc.section.6.2.p.2"><p>For example, because the <tt>Alt-Svc</tt> header field <a href="#I-D.ietf-httpbis-alt-svc"><cite title="HTTP Alternative Services">[I-D.ietf-httpbis-alt-svc]</cite></a> likely appears in an unauthenticated and unencrypted channel, it is subject to downgrade by network attackers. In its simplest form, an attacker that wants the connection to remain in the clear need only strip the <tt>Alt-Svc</tt> header field from responses.</p></div><div id="rfc.section.6.2.p.3"><p>Downgrade attacks can be partially mitigated using the <tt>HTTP-TLS</tt> header field, because when it is used, a client can avoid using cleartext to contact a supporting server. However, this only works when a previous connection has been established without an active attacker present; a continuously present active attacker can either prevent the client from ever using TLS, or offer its own certificate.</p></div></div><div id="privacy"><h3 id="rfc.section.6.3"><a href="#rfc.section.6.3">6.3</a>&nbsp;<a href="#privacy">Privacy Considerations</a></h3><div id="rfc.section.6.3.p.1"><p>Cached alternative services can be used to track clients over time; e.g., using a user-specific hostname. Clearing the cache reduces the ability of servers to track clients; therefore clients MUST clear cached alternative service information when clearing other origin-based state (i.e., cookies).</p></div></div><div id="confusion-regarding-request-scheme"><h3 id="rfc.section.6.4"><a href="#rfc.section.6.4">6.4</a>&nbsp;<a href="#confusion-regarding-request-scheme">Confusion Regarding Request Scheme</a></h3><div id="rfc.section.6.4.p.1"><p>Many existing HTTP/1.1 implementations use the presence or absence of TLS in the stack to determine whether requests are for <tt>http</tt> or <tt>https</tt> resources. This is necessary in many cases because the most common form of an HTTP/1.1 request does not carry an explicit indication of the URI scheme.</p></div><div id="rfc.section.6.4.p.2"><p>HTTP/1.1 MUST NOT be used for opportunistically secured requests.</p></div><div id="rfc.section.6.4.p.3"><p>Some HTTP/1.1 implementations use ambient signals to determine if a request is for an <tt>https</tt> resource. For example, implementations might look for TLS on the stack or a port number of 443. An implementation that supports opportunistically secured requests SHOULD suppress these signals if there is any potential for confusion.</p></div></div></div><h2 id="rfc.references"><a id="rfc.section.7" href="#rfc.section.7">7.</a> References</h2><h3 id="rfc.references.1"><a href="#rfc.section.7.1" id="rfc.section.7.1">7.1</a> Normative References</h3><dl class="dl-horizontal"><dt id="I-D.ietf-httpbis-alt-svc">[I-D.ietf-httpbis-alt-svc]</dt><dd>mnot, m., McManus, P., and J. Reschke, “<a href="https://tools.ietf.org/html/draft-ietf-httpbis-alt-svc-09">HTTP Alternative Services</a>”, Internet-Draft&nbsp;draft-ietf-httpbis-alt-svc-09 (work in progress), November&nbsp;2015.</dd><dt id="RFC2119">[RFC2119]</dt><dd>Bradner, S., “<a href="http://www.rfc-editor.org/info/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>”, BCP&nbsp;14, RFC&nbsp;2119, <a href="http://dx.doi.org/10.17487/RFC2119">DOI&nbsp;10.17487/RFC2119</a>, March&nbsp;1997, &lt;<a href="http://www.rfc-editor.org/info/rfc2119">http://www.rfc-editor.org/info/rfc2119</a>&gt;.</dd><dt id="RFC2818">[RFC2818]</dt><dd>Rescorla, E., “<a href="http://www.rfc-editor.org/info/rfc2818">HTTP Over TLS</a>”, RFC&nbsp;2818, <a href="http://dx.doi.org/10.17487/RFC2818">DOI&nbsp;10.17487/RFC2818</a>, May&nbsp;2000, &lt;<a href="http://www.rfc-editor.org/info/rfc2818">http://www.rfc-editor.org/info/rfc2818</a>&gt;.</dd><dt id="RFC5246">[RFC5246]</dt><dd>Dierks, T. and E. Rescorla, “<a href="http://www.rfc-editor.org/info/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>”, RFC&nbsp;5246, <a href="http://dx.doi.org/10.17487/RFC5246">DOI&nbsp;10.17487/RFC5246</a>, August&nbsp;2008, &lt;<a href="http://www.rfc-editor.org/info/rfc5246">http://www.rfc-editor.org/info/rfc5246</a>&gt;.</dd><dt id="RFC6454">[RFC6454]</dt><dd>Barth, A., “<a href="http://www.rfc-editor.org/info/rfc6454">The Web Origin Concept</a>”, RFC&nbsp;6454, <a href="http://dx.doi.org/10.17487/RFC6454">DOI&nbsp;10.17487/RFC6454</a>, December&nbsp;2011, &lt;<a href="http://www.rfc-editor.org/info/rfc6454">http://www.rfc-editor.org/info/rfc6454</a>&gt;.</dd><dt id="RFC7230">[RFC7230]</dt><dd>Fielding, R., Ed. and J. Reschke, Ed., “<a href="http://www.rfc-editor.org/info/rfc7230">Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing</a>”, RFC&nbsp;7230, <a href="http://dx.doi.org/10.17487/RFC7230">DOI&nbsp;10.17487/RFC7230</a>, June&nbsp;2014, &lt;<a href="http://www.rfc-editor.org/info/rfc7230">http://www.rfc-editor.org/info/rfc7230</a>&gt;.</dd><dt id="RFC7234">[RFC7234]</dt><dd>Fielding, R., Ed., Nottingham, M., Ed., and J. Reschke, Ed., “<a href="http://www.rfc-editor.org/info/rfc7234">Hypertext Transfer Protocol (HTTP/1.1): Caching</a>”, RFC&nbsp;7234, <a href="http://dx.doi.org/10.17487/RFC7234">DOI&nbsp;10.17487/RFC7234</a>, June&nbsp;2014, &lt;<a href="http://www.rfc-editor.org/info/rfc7234">http://www.rfc-editor.org/info/rfc7234</a>&gt;.</dd><dt id="RFC7469">[RFC7469]</dt><dd>Evans, C., Palmer, C., and R. Sleevi, “<a href="http://www.rfc-editor.org/info/rfc7469">Public Key Pinning Extension for HTTP</a>”, RFC&nbsp;7469, <a href="http://dx.doi.org/10.17487/RFC7469">DOI&nbsp;10.17487/RFC7469</a>, April&nbsp;2015, &lt;<a href="http://www.rfc-editor.org/info/rfc7469">http://www.rfc-editor.org/info/rfc7469</a>&gt;.</dd><dt id="RFC7540">[RFC7540]</dt><dd>Belshe, M., Peon, R., and M. Thomson, Ed., “<a href="http://www.rfc-editor.org/info/rfc7540">Hypertext Transfer Protocol Version 2 (HTTP/2)</a>”, RFC&nbsp;7540, <a href="http://dx.doi.org/10.17487/RFC7540">DOI&nbsp;10.17487/RFC7540</a>, May&nbsp;2015, &lt;<a href="http://www.rfc-editor.org/info/rfc7540">http://www.rfc-editor.org/info/rfc7540</a>&gt;.</dd></dl><h3 id="rfc.references.2"><a href="#rfc.section.7.2" id="rfc.section.7.2">7.2</a> Informative References</h3><dl class="dl-horizontal"><dt id="RFC7258">[RFC7258]</dt><dd>Farrell, S. and H. Tschofenig, “<a href="http://www.rfc-editor.org/info/rfc7258">Pervasive Monitoring Is an Attack</a>”, BCP&nbsp;188, RFC&nbsp;7258, <a href="http://dx.doi.org/10.17487/RFC7258">DOI&nbsp;10.17487/RFC7258</a>, May&nbsp;2014, &lt;<a href="http://www.rfc-editor.org/info/rfc7258">http://www.rfc-editor.org/info/rfc7258</a>&gt;.</dd><dt id="RFC7435">[RFC7435]</dt><dd>Dukhovni, V., “<a href="http://www.rfc-editor.org/info/rfc7435">Opportunistic Security: Some Protection Most of the Time</a>”, RFC&nbsp;7435, <a href="http://dx.doi.org/10.17487/RFC7435">DOI&nbsp;10.17487/RFC7435</a>, December&nbsp;2014, &lt;<a href="http://www.rfc-editor.org/info/rfc7435">http://www.rfc-editor.org/info/rfc7435</a>&gt;.</dd></dl><div id="acknowledgements"><h2 id="rfc.section.A" class="np"><a href="#rfc.section.A">A.</a>&nbsp;<a href="#acknowledgements">Acknowledgements</a></h2><div id="rfc.section.A.p.1"><p>Thanks to Patrick McManus, Eliot Lear, Stephen Farrell, Guy Podjarny, Stephen Ludin, Erik Nygren, Paul Hoffman, Adam Langley, Eric Rescorla and Richard Barnes for their feedback and suggestions.</p></div></div><div class="avoidbreakinside"><h2 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h2><p><b>Mark Nottingham</b><br>EMail: <a href="mailto:mnot@mnot.net">mnot@mnot.net</a><br>URI: <a href="http://www.mnot.net/">http://www.mnot.net/</a></p><p><b>Martin Thomson</b><br>Mozilla<br>EMail: <a href="mailto:martin.thomson@gmail.com">martin.thomson@gmail.com</a></p></div></div></div></div><script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script></body></html>